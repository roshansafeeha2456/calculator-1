import tkinter as tk
from tkinter import messagebox
import math
import speech_recognition as sr

# Safe evaluation using math functions
def evaluate_expression(expr):
    try:
        expr = expr.replace('^', '**')  # Allow power notation
        return eval(expr, {"__builtins__": None}, math.__dict__)
    except Exception as e:
        return f"Error: {str(e)}"

# Voice input using speech recognition
def voice_input():
    recognizer = sr.Recognizer()
    with sr.Microphone() as source:
        messagebox.showinfo("Voice Input", "Speak your expression now...")
        audio = recognizer.listen(source)
    try:
        spoken_text = recognizer.recognize_google(audio)
        entry.delete(0, tk.END)
        entry.insert(0, spoken_text)
        result.set(evaluate_expression(spoken_text))
    except Exception as e:
        result.set("Error recognizing speech")

# Calculate result
def calculate():
    expression = entry.get()
    result.set(evaluate_expression(expression))

# Create GUI
app = tk.Tk()
app.title("ðŸ§  Smart Calculator")
app.geometry("400x300")
app.config(bg="#f0f0f0")

tk.Label(app, text="Enter Expression:", font=("Arial", 14), bg="#f0f0f0").pack(pady=10)

entry = tk.Entry(app, font=("Arial", 16), width=25)
entry.pack(pady=10)

tk.Button(app, text="ðŸ§® Calculate", font=("Arial", 12), command=calculate).pack(pady=5)
tk.Button(app, text="ðŸŽ¤ Voice Input", font=("Arial", 12), command=voice_input).pack(pady=5)

result = tk.StringVar()
tk.Label(app, textvariable=result, font=("Arial", 16), fg="blue", bg="#f0f0f0").pack(pady=20)

tk.Label(app, text="Try: sin(0), sqrt(16), log(10), 2^3, etc.", font=("Arial", 10), bg="#f0f0f0").pack()

app.mainloop()
